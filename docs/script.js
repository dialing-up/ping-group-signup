// object lists of all ping groups
/*
//cards
let policy = {
    ALTRUISM	Charity, volunteering, donation, and more
    BLUE-DOGS	For Blue Dog Coalition democrats
    CANLIB	Discussion of Canada's liberal parties
    DOWNBALLOT	For downballot races in the US
    DEMOCRACY	For discussing democratization around the world (not the game)
    DEMS	US Democratic Party discussion
    ECO	Environmentalism
    ELECTIONS	For discussion of elections, especially international ones
    FEMINISTS	Feminism and women's issues
    FOREIGN-POLICY	Doves and Hawks (Formerly INTERVENE)
    GEORGIST	Adherents of Georgism
    HEALTH-POLICY	The business of saving lives
    IMMIGRATION	Immigration & open borders
    INTERNATIONAL-RELATIONS	For academic-type discussion of International Relations (IR)
    LABOR	Labor issues including unions and minimum wage
    LAW	Law
    MARKETS	"Because /r/wallstreetbets is for shitposts and /r/investing is boring"
    MILITARY	Military matters
    PIDGIN	Senate Judicial Committee discussion
    RADXC	Radical Exchange / Radical Markets
    RINO	For refugees of the GOP
    SNEK	For the libertarian-minded
    TAX	Taxes
    YIMBY	Urban development, infrastructure, zoning and more
};*/
/*
//buttons with emoji
let demo = {
    BALD	For the bald and balding
    CHILD	For the literal children of NL
    CHRISTIAN	Christians of NL
    FEMALE	The women of NL
    GEFILTE	Jews and discussion of Judaism
    ISLAM	Muslims and discussion of Islam
    LGBT	LGBT issues
    OVER25	The elderly of NL
    
    RURAL	ðŸ¤ ðŸŒ½ For the density-challenged ðŸ‘©â€ðŸŒ¾ ðŸ‘¨â€ðŸŒ¾
    SHORT	For the vertically-challenged and their allies
    TALL	For the lanklets
};
//special cards
let special = {
    ANNOUNCEMENTS	Announcements pertaining to the subreddit or the Neoliberal Project, eg. podcast episodes and meetups
    MICSPAM	Occasionally moderators run a Discord voice chat, join this group to be notified when it's live
}

let sports = {
    BASEBALL	Baseball
    CBB	College basketball
    CFB	College football
    FFB	Fantasy Football
    MMA	MMA (including, but not limited to, UFC)
    MOTO	Motorsports incl. F1, Formula E and other vroom vroom that go fast
    PRO-WRESTLING	Professional wrestling, including WWE
    NBA	Basketball
    NFL	American football
    NHL	Hockey
    SOCCER	Soccer / Association football
}
let music = {
    CLASSICAL	Classical music
    ELECTRONICA	For electronic music outside mainstream EDM
    FOLK	Folk, Country, Blues, and Americana music
    INDIE	Indie Music
    JAZZ	Jazz music
    METAL	Metal music
    MUSICIAN	Musicians, music making, theory, performance, and more
    OONTS	For EDM and good times
    POP	Pop music
    PRETENTIOUS	Prog Metal, Prog Rock, Math Rock, Post Rock and such
    PUNK	Punk music
    RAP	Rap music
    WORLD-MUSIC	World Music
}

let tv = {
    ASOIAF	A Song of Ice and Fire / Game of Thrones
    AVATAR	The Last Airbender (ATLA) and The Legend of Korra. No blue aliens
    EXPANSE	The Expanse
    HORROR	Fictional horror stories and allegedly true scary stories
    MOVIES	Movies, film, and cinema
    NORTHERNLION	NorthernLion YouTube channel
    READING	Books, literature, short stories, and whatever else you read.
    SANDERSON	Brandon Sanderson's books
    SCI-FI	Science Fiction
    SNL	Saturday Night Live
    SURVIVOR	Survivor
    THEGOODPLACE	The Good Place
    TREK	Star Trek
    TV	General television discussion
    WEEBS	Anime, Manga and assorted weeb stuff
    WEST-WING	The West Wing
}

Online
Group name	Description
ASK-NL	For asking /r/neoliberal questions
BESTOF	For the best content on /r/neoliberal
NL-ELECTS	In which /r/Neoliberal votes in mock elections
PMG-LIST	For high-effort papermarioguy02 comments (incl. econ, baseball, videogames)
PREZPOLL	In which /r/Neoliberal rates presidencies throughout history
READ-ANOTHER-BOOK	/u/PaulaTreides0's personal shitposting ping
SHITPOSTERS	Helping each other craft quality memes to reach /r/All
SPECIES	/u/p00bix's "Neoliberal evolves a species" series
TACOTUBE	Shillpilling the masses of YouTube
WIKI	Wikipedia
//cards
News
Group name	Description
EXTREMISM	For discussion of extremist groups, including insurgencies
FIVEY	For discussion of political polling
NPR	News for the city-slickin, snotty-sneerin, latte-sippin, liberal-leanin
GOOD-NEWS	Good News
//buttons
People & Life
Interests & Fun

    //buttons	
    Health & Wellness
    Group name	Description
    ACCOUNTABILITY	Stronger together
    BIKE	Bicycling
    COOKING	Chefs and hungrybois
    CORONAVIRUS	Coronavirus, COVID-19, SARS-CoV-2
    FAMILY	Family
    FITNESS	Fitness
    FOX-ANON	Support group for those whose loved ones have gone off the Fox News deep end.
    INSOMNIA	For the sleep-deprived of NL
    VEGAN	Vegans
}

*/

let games = {
    AMONG_US: "Among Us",
    ANIMAL_CROSSING:"Animal Crossing",
    BIOWARE:"Bioware Games",
    BLIZZARD:"Blizzard Games",
    CHESS:"Chess",
    CIV:"Sid Meier's Civilization",
    DIPLOMACY:"Diplomacy",
    DOOM:"DOOM",
    DOTA2:"DOTA",
    FALLOUT:"Fallout",
    FIRE_EMB:"Fire Emblem",
    HALO:"Halo",
    HOI4:"Hearts of Iron 4",
    MINECRAFT:"Minecraft",
    MTG:"Magic The Gathering",
    NATIONSTATES:"NationStates Simulation",
    PARADOX:"Paradox games (other than Stellaris and HOI4)",
    RPG:"Tabletop RPGs (like D&D, Shadownrun etc)",
    SHITLER:"Secret Hitler",
    STELLARIS:"Stellaris",
    TES:"The Elder Scrolls",
    XCOM:"XCOM"
};

let general ={
    HORROR: "ðŸ˜± Horror",
    READING: "ðŸ“š Reading",
    MOVIES: "ðŸ“½ï¸ Movies",
    SCI_FI: "ðŸ¤– Sci-Fi",
    TV: "ðŸ“º TV",
    GAMING: "ðŸŽ® Gaming",
    WEEBS: "(âœ¿â— â€¿â— ) Anime and Manga",
    LGBT: "ðŸ³ï¸â€ðŸŒˆ LGBT",
};


let school = {
    AI:"Artificial Intelligence",
    ASTRONOMY:"Astronomy",
    AVIATION:"Aviation",
    BIGDATA:"Data Science",
    CAREER:"Career and Job discussion",
    COLLEGE:"College classes, applications, life and more",
    CLASSICS:"Classical Studies",
    COMPUTER_SCIENCE:"CS and Software Development",
    COURT_CASE:"Court cases and Filings.",
    DEBATE:"Debate",
    ECE:"Electronics and Computer Engineering",
    ECON:"Economics",
    HISTORY:"History",
    LANGUAGE:"Linguistics and language learning",
    LAW_SCHOOL:"Law School",
    MATHEMATICS:"Mathematics",
    MUN:"Model United Nations",
    PHILOSOPHY:"Philosophy",
    PHD: "PHDs",
    STEM:"STEM",
    TEACHERS:"Teachers"
};

let countrylist = {
    AFRICA: "Africa",
    BALKANS: "Balkan Nations",
    CAN: "Canada",
    CN_TW: "Mainland China and Taiwan",
    IND: "India",
    V4: "Visegrad 4 Nations",
    CZECH: "Czech Republic",
    BENE: "Benelux Nations",
    FRANCE: "France",
    GER: "Germany",
    ITALY: "Italy",
    SWISS: "Switzerland",
    UK: "United Kingdom",
    EUROPE: "Europe (general)",
    SEA: "Southeast Asia",
    LATAM: "Latin America",
    SCAN: "Scandinavia",
    DEN: "Denmark",
    SWE: "Sweden",
    NOR: "Norway",
    RUS: "Russia",
    ISRAEL: "Israel",
    JAPAN: "Japan",
    AUS: "Australia",
    NZ: "New Zealand"
};

let statelist = {
    USA_AZ:	"Arizona",
    USA_CA:	"California",
    USA_CO:	"Colorado",
    USA_FL:	"Florida",
    USA_GA:	"Georgia",
    USA_IN:	"Indiana",
    USA_MI:	"Michigan",
    USA_MN:	"Minnesota",
    USA_MO:	"Missouri",
    USA_NE:	"New England",
    USA_NY:	"New York State",
    USA_OH:	"Ohio",
    USA_OR:	"Oregon",
    USA_PA:	"Pennsylvania",
    USA_TX:	"Texas",
    USA_UT:	"Utah",
    USA_WA:	"Washington state",
    USA_WI:	"Wisconsin"
}

let interests = {
    ALCOHOL:	"Alcohol",
    ALTHISTORY:	"Alternative history",
    ANDROID: "Android OS",
    COFFEE:	"Coffee",
    DOG:	"Dogs",
    FASHION:	"Fashion",
    GARAND:	"Guns and firearms",
    KITTY:	"Cats",
    OUTDOORS:	"Outdoor activities (fishing, hiking, camping, etc.)",
    PANDA:	"Panda Bears",
    PC_BUILDING:	"Building PCs",
    RELIGION:	"Religion",
    SPACEFLIGHT:	"Spaceflight and Spacecraft",
    TECH:	"Technology",
    TRAVEL:	"Travel",
    WEED:	"Cannabis",
    WRITING: "Writing"
}

//functions

//function to generate clickable cards with prictures
function cardCloud(id, list, cardstyle){
    for(let key in list){
        let node = document.createElement("div");
        node.className = String(cardstyle);
        node.setAttribute("id",String(key));
        node.setAttribute("onclick","clicker(this, '" + String(cardstyle) + "')");
        let image = document.createElement("img");
        image.setAttribute('src', String(id) + '/' + String(key) + '.svg');
        image.setAttribute('alt', String(list[key]));
        node.appendChild(image);
        let desc = document.createElement("p");
        desc.className ="font-semibold text-xs sm:text-base text-center py-2";
        desc.textContent = String(list[key]);
        node.appendChild(desc);
        document.getElementById(String(id)).appendChild(node);
    }
}

//function to generate pill clouds 
function tagCloud(id, listed, btnstyle){
    for(let key in listed){
        let node = document.createElement("button");
        node.className = String(btnstyle);
        node.textContent = String(listed[key]);
        node.setAttribute("id",String(key));
        node.setAttribute("onclick","clicker(this, '" + String(btnstyle) + "')");
        document.getElementById(String(id)).appendChild(node);
    }
}

//function to toggle look of buttons when clicked and toggle the SELECTED class
function clicker(id, style){
    let spec = String(style);
    let clicked = spec + "_clicked";
    id.classList.toggle(spec);
    id.classList.toggle(clicked);
    id.classList.toggle("SELECTED");
}

//getting the credentials
const url = new URL(window.location.href);
const cred = url.hash.replace('#', '').split('&').reduce((prev, item) => {
    return Object.assign({[item.split('=')[0]]: item.split('=')[1]}, prev);
    }, {});
console.log(cred);
let access = String(cred.access_token);
let selectlist = [];

//function to read all the items selected and send them to group bot. Also changes the look of the submit button
function submit(){
    //read();
    let submitlist = document.getElementById("alerted");
    submitlist.classList.toggle("hidden");
    let i4 = document.getElementById("arrow");
    i4.classList.add("hidden");
    let i1 = document.getElementById("processing");
    i1.classList.toggle("hidden");
    let node1 = document.getElementById("exectext");
    node1.textContent = "Processing";
    let node2 = document.getElementById("exec");
    node2.disabled = true;
    node2.classList.remove("bg-blue-400");
    node2.classList.add("bg-red-400");
    node2.classList.add("cursor-not-allowed");
    const list = document.querySelectorAll('.SELECTED');
    for (let item of list) {
        let selectitem = String(item.getAttribute("id")).replace("_","-");
        selectlist.push(selectitem);
        post(selectitem);
    }
    setTimeout(function(){
    node2.classList.remove("bg-red-400");
    node2.classList.add("bg-green-400");
    node1.textContent = "Finished";
    i1.classList.toggle("hidden");
    let i2 = document.getElementById("finished");
    i2.classList.toggle("hidden");
    console.log(selectlist);
    }, 500);
}


//function to read the username
function read(){
    fetch('https://oauth.reddit.com/api/v1/me',{
        mode: "cors",
        headers: {"Authorization": "bearer " + access }
    }).then(function (response) {
        // The API call was successful!
        if (response.ok) {
            return response.json();
        } else {
            return Promise.reject(response);
        }
    }).then(function (data) {
        // This is the JSON from our response
        let node = document.getElementById("username");
        node.textContent = "Hello, " + String(data.name);
    }).catch(function (err) {
        // There was an error
        console.warn('Something went wrong.', err);
        let node = document.getElementById("username");
        node.textContent = "Something went wrong";
    });
}

//function to send one message to groupbot
function post(ping){
    let node2 = document.getElementById("submitlist");
    let li = document.createElement("li");
    let message = {
        api_type: "json",
        subject: "ADD yourself to group " + String(ping),
        text: "addtogroup " + String(ping),
        to: "groupbot"
    };
    let query = ""
    for (let d in message){
         query += encodeURIComponent(d) + '=' + 
            encodeURIComponent(message[d]) + '&'
    }
    fetch('https://oauth.reddit.com/api/compose?'+query,{
        method: "POST",
        mode: "cors",
        headers: {"Authorization": "bearer " + access }
    }).then(function (response) {
        // The API call was successful!
        if (response.ok) {
            return response.json();
        } else {
            return Promise.reject(response);
        }
    }).then(function (data) {
        // This is the JSON from our response
        console.log(data);
        li.className = "text-green-600";
        li.textContent = "Message sent to add to group " + ping;
        node2.appendChild(li);
    }).catch(function (err) {
        // There was an error
        console.warn('Something went wrong.', err);
        li.className = "text-red-600";
        li.textContent = "Failed to send message to add to group " + ping;
        node2.appendChild(li);
    });   
}

//hover:text-white hover:bg-gradient-to-r hover:from-red-400 hover:to-yellow-400

 /*   axios('https://oauth.reddit.com/api/v1/me',{
        method: 'GET',
        headers: {"Authorization": "bearer " + access}
    })
    .then(function (response) {
    // handle success
    console.log(response);
    })
    .catch(function (error) {
    // handle error
    console.log(error);
    })
    .then(function () {
    // always executed
    });
    axios.post('https://oauth.reddit.com/api/compose', {
        api_type: "json",	
        subject: "Add yourself to group SCIFI",    
        text: "addtogroup SCIFI",
        to: "groupbot"
    },
    {
        "Authorization": "bearer " + access
    })
    .then(function (response) {
        console.log(response.data);
    })
    .catch(function (error) {
        console.log(error);
    }); */ 

/*  

https://not-an-aardvark.github.io/snoowrap/snoowrap-v1.min.js

const generateRandomString = (length=6)=>Math.random().toString(20).substr(2, length)

<div class="flex justify-around">
    <span class="inline-flex rounded-md shadow-sm">
      <button type="button" class="inline-flex items-center px-4 py-2 border border-transparent text-base leading-6 font-medium rounded-md text-white bg-rose-600 hover:bg-rose-500 focus:border-rose-700 active:bg-rose-700 transition ease-in-out duration-150 cursor-not-allowed" disabled>
        <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
          <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
          <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
        </svg>
        Processing
      </button>
    </span>
  </div> */